@startuml
'https://plantuml.com/sequence-diagram

!theme mars
autonumber

title Animation Sequence Flow

control EventLoop
participant Window
participant Operator
participant AnimationManager as AM
participant Animation
participant Cube

== User Action ==

EventLoop -> Window: key_press (e.g., 'R')
Window -> Operator: play(alg)

== Animation Setup ==

Operator -> AM: run_animation(alg)
AM -> AM: create Animation
AM -> EventLoop: schedule_interval(update)

== Animation Loop ==

loop until animation.done

    EventLoop -> AM: update callback
    AM -> Animation: update_gui_elements()
    note right: Calculate rotation angle\nbased on elapsed time

    EventLoop -> Window: on_draw
    Window -> AM: draw()
    AM -> Animation: draw()
    note right: Draw rotating slices\nat current angle

end

== Cleanup ==

AM -> Animation: cleanup()
AM -> Operator: op(alg, inv=False)
note right: Actually apply the\nmove to the cube
Operator -> Cube: alg.play(cube)

AM -> EventLoop: unschedule(update)
AM -> Window: update_gui_elements()

@enduml
